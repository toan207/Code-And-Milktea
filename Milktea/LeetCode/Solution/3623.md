> https://leetcode.com/problems/count-number-of-trapezoids-i

## Bài toán

```
You are given a 2D integer array points, where points[i] = [xi, yi] represents the coordinates of the ith point on the Cartesian plane. 

A horizontal trapezoid is a convex quadrilateral with at least one pair of horizontal sides (i.e. parallel to the x-axis). Two lines are parallel if and only if they have the same slope. 

Return the number of unique horizontal trapezoids that can be formed by choosing any four distinct points from points. Since the answer may be very large, return it modulo 10^9 + 7.
```

## Điều kiện
- 4 <= points.length <= 10^5
- -10^8 <= xi, yi <= 10^8
- Tất cả các cặp cạnh không trùng

## Tóm tắt

- Gom các điểm theo **giá trị y**.  
- Với mỗi đường ngang có `c` điểm: số cách chọn **2 điểm** tạo một cạnh ngang:

$$
v = C(c, 2) = \frac{c(c-1)}{2}
$$

- Chọn 2 điểm trên đường ngang `y1` và 2 điểm trên đường ngang khác `y2` → tạo 1 hình thang ngang.  
- Dùng **prefix sum** để tính nhanh, tránh duyệt tất cả cặp đường ngang (O(k²)).

## Nhận xét

1. **Điều kiện tạo hình thang ngang**  
   - Cần hai đường ngang khác nhau (`y1 != y2`) và mỗi đường ≥2 điểm.  
   - 2 điểm trên y1 → cạnh trên, 2 điểm trên y2 → cạnh dưới → tạo hình thang.

2. **Tổng số hình thang**
$$
\sum_{i<j} v_i \cdot v_j
$$

3. **Tối ưu prefix sum**
   - Duyệt tất cả cặp đường ngang → O(k²)  
   - Dùng prefix sum:  
     - `prefixSum` = tổng các v đã duyệt  
     - Với đường ngang hiện tại có v → `res += prefixSum * v`  
     - Cập nhật `prefixSum += v`  
   - Giảm độ phức tạp xuống O(k).

4. **Không cần kiểm tra lồi**  
   - 2 điểm trên mỗi đường ngang → đoạn thẳng song song → tứ giác luôn lồi.  

5. **Độ phức tạp**  
   - **Thời gian:** O(n + k) (n = số điểm, k = số giá trị y khác nhau)  
   - **Bộ nhớ:** O(k)

## Mã giả

```
group points by y → countPointInY

prefixSum = 0
res = 0

for each count in countPointInY.values():
    v = C(count, 2)

    res += prefixSum * v
    prefixSum += v

return res mod 1e9+7
```

## Code giải

[Python](https://github.com/toan207/Code-And-Milktea/blob/main/Milktea/LeetCode/Code/Python/3623.py), [Golang](https://github.com/toan207/Code-And-Milktea/blob/main/Milktea/LeetCode/Code/Golang/3623.go), [Java](https://github.com/toan207/Code-And-Milktea/blob/main/Milktea/LeetCode/Code/Java/_3623.java), [JavaScript](https://github.com/toan207/Code-And-Milktea/blob/main/Milktea/LeetCode/Code/JavaScript/3623.js)
